# ğŸ¯ 03-09. ì»´í¬ë„ŒíŠ¸ì—ì„œ ì½œë°± í•¨ìˆ˜ì™€ ì´ë²¤íŠ¸ ì²˜ë¦¬ í•˜ê¸°

í•˜ìœ„ì—ì„œ í”„ë¡œí¼í‹°ë¥¼ ë³€ê²½í•´ì•¼ í•  ë•ŒëŠ” ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?<br/>**í”„ë¡œí¼í‹° ì›ë³¸ì„ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì— ì œê³µ**í•œë‹¤.<br/>ì½œë°±í•¨ìˆ˜ëŠ” ì •ì˜ëœ ìœ„ì¹˜ê°€ ì•„ë‹Œ íŠ¹ì • ìƒí™©ì—ì„œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— ì½œë°± í•¨ìˆ˜ë¥¼ í”„ë¡œí¼í‹°ë¡œ ì „ë‹¬í•˜ë©´ ëœë‹¤.



## ğŸŒ ì½œë°± í•¨ìˆ˜ë¡œ í”„ë¡œí¼í‹° ìˆ˜ì •í•´ ë³´ê¸°

```jsx
// ./src/03/CounterApp.jsx
import React, { Component } from 'react';
import Counter from './03/Counter2';
class Counter extends Component {
  constructor(props) {
    super(props);
    this.state = {
      count: props.count,
    };
    this.increaseCount = this.increaseCount.bind(this);
  }
  increaseCount() {
    this.setState(({ count }) => ({
      count :count+1
    }));
  }
  render() {
    return (
      <div>
        í˜„ì¬ ì¹´ìš´íŠ¸ : {this.state.count}
        <button onClick={this.increaseCount}>ì¹´ìš´íŠ¸ ì¦ê°€</button>
      </div>
    );
  }
}

export default Counter;
```

ìœ„ì˜ ê²½ìš° Appì»´í¬ë„ŒíŠ¸ì—ì„œ stateë¡œ ê´€ë¦¬í•˜ëŠ” countê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆì§€ë§Œ Counterì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ìƒíƒœ.

```jsx
// App.jsx
import React, { Component } from 'react';
import Counter from './03/Counter2';
class App extends Component {
  constructor(props) {
    super(props);
    this.state = { count: 10 };
  }
  increateCount() {
    this.setState(({ count }) => ({ count: count + 10 }));
  }
  render() {
    return (
      <Counter count={this.state.count} onAdd={this.increateCount} />
    );
  }
}

export default App;
```

Counterì»´í¬ë„ŒíŠ¸ì˜ í”„ë¡œí¼í‹°ë¡œonAddë¥¼ ì¶”ê°€í•´ ì½œë°±í•¨ìˆ˜ë¥¼ ë³´ë‚¸ë‹¤.

```jsx
// ./src/03/Counter2.jsx
import React, { Component } from 'react';
import PropTypes from 'prop-types';

class Counter2 extends Component {
  render() {
    return (
      <div>
        í˜„ì¬ ì¹´ìš´íŠ¸ : {this.props.count}
        <button onClick={this.props.onAdd()}>ì¹´ìš´íŠ¸ ì¦ê°€</button>
      </div>
    );
  }
}

Counter2.propTypes = {
  count: PropType.number,
  onAdd: PropType.func,
};

export default Counter2;
```



### â—ï¸ ì˜¤ë¥˜ë°œìƒ

```text
Uncaught TypeError : this.setState is not a function
```

Counter2ì—ì„œ í”„ë¡œí¼í‹°ë¡œ ë°›ì•„ ì‹¤í–‰í•œ **onAdd()í•¨ìˆ˜ì—ì„œ ì°¸ì¡°í•˜ëŠ” thisì˜ ë²”ìœ„ ë•Œë¬¸ì— ë°œìƒ.**<br/>onAdd()í•¨ìˆ˜ì— êµ¬í˜„ë˜ìˆëŠ” this.setState(...)ëŠ” ìƒìœ„ì»´í¬ë„ŒíŠ¸(App)ì— ì •ì˜ ë˜ìˆì§€ë§Œ, í•˜ìœ„ì—ì„œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸.<br/>bind()í•¨ìˆ˜ë¥¼ ì´ìš©í•´ í•´ê²°í•  ìˆ˜ ìˆë‹¤.



## ğŸŒ bind()í•¨ìˆ˜ë¡œ thisë²”ìœ„ ì˜¤ë¥˜ í•´ê²°í•˜ê¸°

```jsx
// ./src/App.jsx
...
render() {
    return (
        <Counter count={this.state.count} onAdd={this.increateCount.bind(this)} />
    );
}
...
```

thisì˜ ë²”ìœ„ê°€ Appì»´í¬ë„ŒíŠ¸ì— ë¬¶ì¸ ê²ƒì´ë‹¤.

bind()í•¨ìˆ˜ëŠ” **constructor()í•¨ìˆ˜ì— ëª¨ì•„ë‘ë©´** ë§¤ë²ˆ **render()í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.**

```jsx
// ./src/App.jsx
import React, { Component } from 'react';
import Counter from './03/Counter2';
class App extends Component {
  constructor(props) {
    super(props);
    this.state = { count: 1 };
    this.increateCount = this.increateCount.bind(this)
  }
  increateCount() {
    this.setState(({ count }) => ({ count: count + 1 }));
  }
  render() {
    return (
      <Counter count={this.state.count} onAdd={this.increateCount} />
    );
  }
}

export default App;
```



## ğŸŒ ì»´í¬ë„ŒíŠ¸ì—ì„œ DOM ê°ì²´ í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

window.addEventListener()í•¨ìˆ˜ì™€ ê°™ì€ **DOM ê°ì²´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ DOM ê°ì²´ë¥¼ ì»´í¬ë„ŒíŠ¸ ë³€ìˆ˜ì— í• ë‹¹**í•´ì•¼í•œë‹¤.<br/>ì´ë•Œ **íŠ¹ìˆ˜ í”„ë¡œí¼í‹° refë¥¼ ì‚¬ìš©**í•œë‹¤.<br/>refëŠ” document.getElementById()ê°€ ë°˜í™˜í•˜ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•¨.<br/>DOMê°ì²´ í•¨ìˆ˜ê°€ í•„ìš”í•œ ì—˜ë¦¬ë¨¼íŠ¸ì— ì½œë°± í•¨ìˆ˜í˜•íƒœë¡œ ì „ë‹¬ë¨.

setRef()í•¨ìˆ˜ë¥¼ ì½œë°± í•¨ìˆ˜ í˜•íƒœë¡œ ì „ë‹¬í•œ ë¶€ë¶„ì„ ì£¼ëª©.

```jsx
import React from 'react';

export default class ScrollSpy extends React.PureComponent {
  constructor(props) {
    super(props);
    this.setRef = this.setRef.bind(this);
    this.checkPosition = this.checkPosition.bind(this);
    window.addEventListener('scroll', this.checkPosition);
  }
  setRef(ref) {
    this.ref = ref;
  }

  checkPosition() {
    if (this.ref.getBoundingClientRect().top < window.innerHeight) {
      console.log('enter');
    } else {
      console.log('exit');
    }
  }

  componentDidMount() {
    this.checkPosition();
  }

  componentWillUnmount() {
    window.removeEventListener('scroll', this.checkPosition);
  }

  render() {
    return <div ref={this.setRef} />;
  }
}

```

* window.addEventListener('scroll', this.checkPosition);<br/>ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•´ checkPosition()í•¨ìˆ˜ê°€ ì‹¤í–‰ë¨.
* setRef(ref) {    this.ref = ref;  }<br/>refí”„ë¡œí¼í‹°ì—ì„œ ë°˜í™˜ëœ ê°ì²´ë¥¼ ì»´í¬ë„ŒíŠ¸ ë³€ìˆ˜ì— í• ë‹¹.
* checkPosition(){ if(~~~)}<br/>DOMê°ì²´ì˜ ìœ„ì¹˜ê°€ ìŠ¤í¬ë¡¤ í™”ë©´ ì•ˆíŒì¸ì§€ ì¸¡ì •
* window.removeEventListener('scroll', this.checkPosition);<br/>ì»´í¬ë„ŒíŠ¸ ì†Œë©¸ ì‹œ í™”ë©´ ìŠ¤í¬ë¡¤ ê°ì‹œ í•¨ìˆ˜ë¥¼ ë©”ëª¨ë¦¬ì—ì„œ ì œê±°.

ë¬´í•œ ìŠ¤í¬ë¡¤ì‹œ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì´ë‹¤. console.log('enter')ë¶€ë¶„ì— ë‹¤ìŒ í˜ì´ì§€ ëª©ë¡ì„ ì¶”ê°€í•˜ëŠ” ì½”ë“œë¥¼ êµ¬í˜„í•˜ë©´ ë¨.



## ğŸŒ ì»´í¬ë„ŒíŠ¸ì—ì„œ DOM ì´ë²¤íŠ¸ ì‚¬ìš©í•˜ê¸°

ì´ë²¤íŠ¸ í”„ë¡œí¼í‹°ëŠ” íŠ¹ìˆ˜ í”„ë¡œí¼í‹°ë¡œ ì½œë°± í•¨ìˆ˜ í˜•íƒœë¡œ ì „ë‹¬í•´ ì²˜ë¦¬í•¨.

on+ì´ë²¤íŠ¸ëª… í˜•íƒœì˜ í”„ë¡œí¼í‹°ë¡œ ì œê³µë¨.

```jsx
// ./src/03/Counter03.jsx
import React from 'react';

class Counter3 extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      count: 0,
    };
    this.increateCount = this.increateCount.bind(this);
    this.resetCount = this.resetCount.bind(this);
  }
  increateCount() {
    this.setState(({ count }) => ({ count: count + 1 }));
  }
  resetCount() {
    this.setState({ count: 0 });
  }
  render() {
    return (
      <div>
        í˜„ì¬ ì¹´ìš´íŠ¸: {this.state.count}
        <button
          onClick={this.increateCount}
          onMouseOut={this.resetCount}
        >
          ì¹´ìš´íŠ¸ ì¦ê°€
        </button>
        ë²„íŠ¼ ë°–ìœ¼ë¡œ ì»¤ì„œê°€ ì›€ì§ì´ë©´ 0ìœ¼ë¡œ ì´ˆê¸°í™” ë©ë‹ˆë‹¤.
      </div>
    );
  }
}

export default Counter3;
```

buttonë¶€ë¶„ì— Clickë ë•Œì™€ mouseê°€ ë²„íŠ¼ ë°–ìœ¼ë¡œ ì´ë™í•  ë•Œ ê°ê°ì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.



## ğŸŒ ë‹¨ë°©í–¥ íë¦„ ë°©ì‹ ê°œë… ì •ë¦¬

ë¦¬ì•¡íŠ¸ëŠ” í”„ë¡œí¼í‹°, stateì™€ ê°™ì€ ë°ì´í„°ë¥¼ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ ë°©í–¥ì„ ì „ë‹¬í•œë‹¤.

ë°ì´í„° ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš° ì½œë°± í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì›ë³¸ ë°ì´í„°ê°€ ìœ„ì¹˜í•œ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ê³  ë‹¤ì‹œ ìì‹ ì»´í¬ë„ŒíŠ¸ë¡œ ì „ë‹¬í•˜ë„ë¡ ë§Œë“­ë‹ˆë‹¤.

ì›ë³¸ ë°ì´í„°ì˜ ë¬´ê²°ì„±ì„ ì§€ì¼œì£¼ë¯€ë¡œ ë°ì´í„° ìˆ˜ì •ìœ¼ë¡œ ì¸í•œ ë°ì´í„° íŒŒí¸í™”ë¥¼ ì¤„ì—¬ì¤ë‹ˆë‹¤.